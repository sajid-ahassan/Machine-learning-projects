<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Movie Recommendation System</title>

        <link rel="stylesheet"
            href="{{ url_for('static', filename='style.css') }}" />
        <link rel="stylesheet" href="/static/style.css" />

        <script src="https://cdn.tailwindcss.com"></script>
    </head>

    <body>
        <!-- Navbar -->
        <nav
            class="fixed top-0 left-0 w-full z-50 bg-black/40 backdrop-blur-md border-b border-white/10">
            <div
                class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between text-white">

                <!-- Logo -->
                <div
                    class="text-3xl font-extrabold tracking-wide text-emerald-300">
                    MovieRec
                </div>

                <!-- Desktop Menu -->
                <ul class="hidden md:flex text-lg space-x-10">
                    <li><a href="/"
                            class="hover:text-emerald-400 transition">Home</a></li>
                    <li><a href="/recommend"
                            class="hover:text-emerald-400 transition">Recommendations</a></li>

                </ul>

                <!-- Mobile Button -->
                <button id="menu-btn" class="md:hidden focus:outline-none">
                    <svg class="w-9 h-9" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>

            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu"
                class="md:hidden max-h-0 opacity-0 overflow-hidden transition-all duration-300 px-6 pb-6 text-white space-y-4">
                <a href="/" class="block hover:text-emerald-400">Home</a>
                <a href="/recommend"
                    class="block hover:text-emerald-400">Recommendations</a>
            </div>
        </nav>

        <!-- nab end -->

        <!-- Search bar -->

        <section class="relative h-[700px] w-full overflow-hidden">
            <!-- Background layer -->
            <div id="bg-slider"
                class="absolute inset-0 bg-cover bg-center transition-all duration-300"
                style="
          background-image: url('https://images.unsplash.com/photo-1615986201152-7686a4867f30?q=80&w=1325&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
        "></div>

            <!-- Dark overlay for readability -->
            <div class="absolute inset-0 bg-black/90"></div>

            <!-- Content on top -->
            <div
                class="relative z-10 flex flex-col items-center justify-center h-full text-center px-4">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 text-white">
                    Discover Your Next Favorite Movie
                </h1>
                <p class="text-lg md:text-2xl mb-6 text-gray-200">
                    Smart recommendations based on what you love.
                </p>

                <form action="/recommend_books" method="post"
                    class="w-full max-w-md mx-auto">

                    <!-- Search Input + Suggestions -->
                    <div class="relative w-full">
                        <input
                            id="movie-search"
                            type="text"
                            name="user_input"
                            placeholder="Search movies..."
                            class="w-full px-4 py-2 rounded-lg bg-gray-800/80 text-white border border-gray-600
             focus:outline-none focus:ring-2 focus:ring-red-500 placeholder-gray-400"
                            autocomplete="off" />

                        <div
                            id="suggestions"
                            class="absolute left-0 top-full mt-2 w-full bg-gray-900 text-white rounded-md
             shadow-lg max-h-60 overflow-y-auto hidden z-50 border border-gray-700"></div>
                    </div>

                    <!-- Submit Button -->
                    <button
                        type="submit"
                        class="mt-3 w-full bg-red-600 hover:bg-red-900 text-white font-medium
           py-2 rounded-lg transition duration-300">
                        Search
                    </button>

                </form>

            </div>
        </section>

        <!-- search end -->

        <!-- Card-->

        {% if data %}

        <!-- Recommendations Section -->
        <section class="py-10 bg-white">
            <div class="max-w-5xl mx-auto px-4 text-center">
                <h2 class="text-2xl md:text-3xl font-semibold text-gray-900">
                    Recommendations
                </h2>
                <p class="mt-2 text-gray-600">
                    Here are some of the most similar movies based on your given
                    movie.
                </p>

                <div
                    class="mt-6 h-[2px] w-24 bg-gray-300 mx-auto rounded-full"></div>
            </div>
        </section>

        <!-- Cards Wrapper -->
        <div class="w-full max-w-7xl mx-auto px-4 pt-4 pb-16">
            <div class="flex flex-wrap justify-center gap-6">

                {% for i in data %}
                <a href="/movie_details/{{ i[4] }}"
                    class="w-full sm:w-[48%] md:w-[30%] lg:w-[22%] xl:w-[18%]">

                    <!-- CARD -->
                    <div
                        class="bg-gray-800 text-white rounded-xl overflow-hidden shadow-lg
                        hover:shadow-2xl hover:-translate-y-1 transition duration-300
                        flex flex-row sm:flex-col">

                        <!-- IMAGE (left on mobile, top on larger screens) -->
                        <div
                            class="w-28 h-46 sm:w-full sm:h-56 overflow-hidden">
                            <img src="{{ i[3] }}" alt="Movie Poster"
                                class="w-full h-full object-cover" />
                        </div>

                        <!-- CONTENT -->
                        <div
                            class="p-4 flex flex-col justify-center sm:justify-start flex-1">

                            <!-- Movie Title -->
                            <h2
                                class="text-sm sm:text-base md:text-lg font-semibold leading-tight line-clamp-2">
                                {{ i[0] }}
                            </h2>

                            <!-- Director -->
                            <p
                                class="text-gray-300 text-xs sm:text-sm line-clamp-1 mt-1">
                                <span class="font-semibold">Director:</span> {{
                                i[1] }}
                            </p>

                            <!-- Rating -->
                            <div class="mt-2">
                                <span
                                    class="inline-block bg-emerald-500 text-black px-3 py-1 rounded-full
                                     text-xs sm:text-sm">
                                    ‚≠ê {{ i[2] }}
                                </span>
                            </div>

                        </div>
                    </div>
                    <!-- /CARD -->

                </a>
                {% endfor %}

            </div>
        </div>

        {% endif %}

        <script>
        //<!-- Side bar -->
        const menuBtn = document.getElementById("menu-btn");
        const mobileMenu = document.getElementById("mobile-menu");

        menuBtn.addEventListener("click", () => {
            mobileMenu.classList.toggle("max-h-0"); // collapsed
            mobileMenu.classList.toggle("max-h-96"); // expanded
            mobileMenu.classList.toggle("opacity-0"); // faded out
            mobileMenu.classList.toggle("opacity-100"); // faded in
        });

        //<!-- Search recommendation -->
        const movies = JSON.parse(`{{ titles | tojson | safe }}`);


        const input = document.getElementById("movie-search");
        const box = document.getElementById("suggestions");

        input.addEventListener("input", () => {
            let q = input.value.toLowerCase();
            let results = movies.filter(t => t.toLowerCase().includes(q)).slice(0, 5);

            box.innerHTML = results.map(r =>
            `<div class='px-3 py-2 hover:bg-gray-800 cursor-pointer'>${r}</div>`
            ).join("");

            box.classList.toggle("hidden", results.length === 0);

            [...box.children].forEach(item => {
            item.onclick = () => { input.value = item.innerText; box.classList.add("hidden"); }
            });
        });

    </script>

    </body>

</html>